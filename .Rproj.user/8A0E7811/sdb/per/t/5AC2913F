{
    "collab_server" : "",
    "contents" : "library(shiny)\nlibrary(shinydashboard)\n\ndisplayViewBtn <- function(val) {\n  paste0('<a href=\"http://www.imdb.com/title/',val,'\" target=\"_blank\" class=\"btn btn-primary\">IMDB Info</a>')\n}\n\ndisplayPoster <- function(val) {\n  paste0('<img src=\"',val,'\" alt=\"Image from IMDb is not available.\" height=\"150\" width=\"100\">')\n}\n\ndisplayPoster2 <- function(val) {\n  paste0('<img src=\"',val,'\" alt=\"Image from IMDb is not available.\" height=\"250\" width=\"180\">')\n}\n\ndisplayStar <- function(val) {\n  sprintf(paste('<span class=\"rating\">\n                  <input type=\"radio\" class=\"rating-input\"\n                  id=\"rating-input-1-5-',val,'\" name=\"rating-input-',val,'\">\n                  <label for=\"rating-input-1-5-',val,'\" class=\"rating-star\"></label>\n      \n                  <input type=\"radio\" class=\"rating-input\"\n                  id=\"rating-input-1-4-',val,'\" name=\"rating-input-',val,'\">\n                  <label for=\"rating-input-1-4-',val,'\" class=\"rating-star\"></label>\n      \n                  <input type=\"radio\" class=\"rating-input\"\n                  id=\"rating-input-1-3-',val,'\" name=\"rating-input-',val,'\">\n                  <label for=\"rating-input-1-3-',val,'\" class=\"rating-star\"></label>\n      \n                  <input type=\"radio\" class=\"rating-input\"\n                  id=\"rating-input-1-2-',val,'\" name=\"rating-input-',val,'\">\n                  <label for=\"rating-input-1-2-',val,'\" class=\"rating-star\"></label>\n      \n                  <input type=\"radio\" class=\"rating-input\"\n                  id=\"rating-input-1-1-',val,'\" name=\"rating-input-',val,'\">\n                  <label for=\"rating-input-1-1-',val,'\" class=\"rating-star\"></label>\n      \n                </span>'))\n}\n\ndisplayStar2 <- function(){\n  radioButtons(\"star\", \"Star\", c(\"1star\" = \"1\", \"2star\"=\"2\"))\n}\n\ndisplayWatchedBtn <- function(val) {\n  sprintf('<a href=\"\" target=\"_blank\" class=\"btn btn-primary\">Watched</a>',val)\n}\n\n\nshinyServer(function(input, output,session) {\n  \n  #=========================== home =====================================\n  output$welcome <- renderUI({\n    p(h4(\"Welcome to R-ecommender!\"),\n      \"The content-based recommendation system is running on R programming language with integration of web application using Shiny.\")\n  })\n  \n  #========================= rating =====================================\n \n  output$title_selected <- renderText({\n    input$select_movie\n  })\n  \n  output$poster_selected <- reactive({\n    poster <- displayPoster2(movie_iflix[(movie_iflix$movie_title == input$select_movie),6])\n    return(poster)\n  })\n  \n  #observeEvent(input$submit, {\n  #  saveData(formData())\n  #})\n  \n  #formData <- reactive({\n  #  user_data <- sapply(fields, function(x) input[[x]])\n  #  user_data\n  #})\n  \n  output$user_data <- renderText({\n    input$submit\n    #loadData()\n  })\n  \n  #========================= preference =================================\n  output$preference <- renderUI({\n    p(h4(\"Add your preferences.\"), \n      \"You can also add your preferences of movies based on particular genre, actors, directors, year of production or imdb rating.\",\n      br(),\n      br(),\n      actionButton(\"btn_preference\", label = \"Preferences\")\n      )\n  })\n  \n  #======================== browse =====================================\n  output$action = renderDataTable({\n    movie_actionview$Info <- displayViewBtn(movie_action$imdbID)\n    movie_actionview$Poster <- displayPoster(movie_action$poster)\n    movie_actionview <- movie_actionview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_actionview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$drama = renderDataTable({\n    movie_dramaview$Info <- displayViewBtn(movie_drama$imdbID)\n    movie_dramaview$Poster <- displayPoster(movie_drama$poster)\n    movie_dramaview <- movie_dramaview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_dramaview)\n  },escape = FALSE, options = list(pageLength = 10))\n  output$comedy = renderDataTable({\n    movie_comedyview$Info <- displayViewBtn(movie_comedy$imdbID)\n    movie_comedyview$Poster <- displayPoster(movie_comedy$poster)\n    movie_comedyview <- movie_comedyview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_comedyview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$horror = renderDataTable({\n    movie_horrorview$Info <- displayViewBtn(movie_horror$imdbID)\n    movie_horrorview$Poster <- displayPoster(movie_horror$poster)\n    movie_horrorview <- movie_horrorview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_horrorview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$romance = renderDataTable({\n    movie_romanceview$Info <- displayViewBtn(movie_romance$imdbID)\n    movie_romanceview$Poster <- displayPoster(movie_romance$poster)\n    movie_romanceview <- movie_romanceview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_romanceview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$family = renderDataTable({\n    movie_familyview$Info <- displayViewBtn(movie_family$imdbID)\n    movie_familyview$Poster <- displayPoster(movie_family$poster)\n    movie_familyview <- movie_familyview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_familyview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$thriller = renderDataTable({\n    movie_thrillerview$Info <- displayViewBtn(movie_thriller$imdbID)\n    movie_thrillerview$Poster <- displayPoster(movie_thriller$poster)\n    movie_thrillerview <- movie_thrillerview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_thrillerview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$sci_fi = renderDataTable({\n    movie_scifiview$Info <- displayViewBtn(movie_scifi$imdbID)\n    movie_scifiview$Poster <- displayPoster(movie_scifi$poster)\n    movie_scifiview <- movie_scifiview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_scifiview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$crime = renderDataTable({\n    movie_crimeview$Info <- displayViewBtn(movie_crime$imdbID)\n    movie_crimeview$Poster <- displayPoster(movie_crime$poster)\n    movie_crimeview <- movie_crimeview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_crimeview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$top200 = renderDataTable({\n    movie_top200view$Info <- displayViewBtn(movie_top200$imdbID)\n    movie_top200view$Poster <- displayPoster(movie_top200$poster)\n    movie_top200view <- movie_top200view[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_top200view)\n  }, escape = FALSE, options = list(pageLength = 10))\n  output$all = renderDataTable({\n    movie_iflixview$Info <- displayViewBtn(movie_iflix$imdbID)\n    movie_iflixview$Poster <- displayPoster(movie_iflix$poster)\n    movie_iflixview <- movie_iflixview[,c(\"Poster\",\"Title\",\"Info\")]\n    return(movie_iflixview)\n  }, escape = FALSE, options = list(pageLength = 10))\n  \n})\n",
    "created" : 1482110432474.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1967268494",
    "id" : "5AC2913F",
    "lastKnownWriteTime" : 1485167900,
    "last_content_update" : 1485174596800,
    "path" : "D:/ACAP/FYP/R/Recommender Apps/Recommender Apps4/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}